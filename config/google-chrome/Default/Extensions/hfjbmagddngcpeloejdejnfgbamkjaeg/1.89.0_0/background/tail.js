"use strict";r.Oe(200,function(){function t(t){if(p||t.v||(t.v=K.a(t.u)),null==t.textSplit){t.title=n(t.title);var e=t.t,r=i(e);t.t=e.length!==t.u.length?r:"",t.textSplit=s(r,o(r),e.length-r.length,p?U-13-Math.min(t.title.length,40):U)}else t.t===t.u&&(t.t="")}function n(t,n){var i=t.length>U+40;return i&&(t=r.$(t,0,U+39)),e(i?t+"\u2026":t,n||o(t))}function e(t,n){var e,i,o,u,l;if(0===n.length)return r.R(t);for(e="",i=0,o=0;o<n.length;o+=2)l=n[o+1],(u=n[o])>=t.length||(e+=r.R(t.slice(i,u)),e+="<match>",e+=r.R(t.slice(u,l)),e+="</match>",i=l);return e+r.R(t.slice(i))}function i(t){var n=r.Me(t);return!n||n>=t.length?t:t.slice(n,t.length-+(t.endsWith("/")&&!t.endsWith("://")))}function o(t){var n,e,r,i,o,l,s,f,a,c,_,g=[];for(n=0,e=k.length;n<e;n++)for(r=0,i=0,o=void 0,s=(l=t.split(G.Tr[n])).length-1,f=k[n].length;r<s;r++,i=o)o=(i+=l[r].length)+f,g.push([i,o]);if(0===g.length)return g;if(1===g.length)return g[0];for(g.sort(u),a=g[0],n=1,c=1,e=g.length;c<e;c++)a[n]>=(_=g[c])[0]?a[n]<_[1]&&(a[n]=_[1]):(a.push(_[0],_[1]),n+=2);return a}function u(t,n){return t[0]-n[0]}function s(t,n,e,i){var o,u,l,s,f,a="",c=t.length,_=c,g="";if(c<=i||(e>1?_=t.indexOf("/")+1||c:(_=t.indexOf(":"))<0?_=c:r.G.test(t.slice(0,_+3).toLowerCase())?_=t.indexOf("/",_+4)+1||c:_+=22),_<c&&n.length)for(o=n.length,u=c+8;(o-=2)>-4&&u>=_;u=o<0?0:n[o])if(l=o<0?_:n[o+1],(s=u-20-Math.max(l,_))>0&&(c-=s)<=i){_=l+(i-c);break}for(c=0,o=0;c<i&&o<n.length;o+=2)(s=(u=n[o])-20-(f=Math.max(c,_)))>0?(i+=s,g=r.$(t,c,f+11),a+=r.R(g),a+="\u2026",g=r.z(t,u-8,u),a+=r.R(g)):c<u&&(g=t.slice(c,u),a+=r.R(g)),g=t.slice(u,c=n[o+1]),a+="<match>",a+=r.R(g),a+="</match>";return t.length<=i?(g=t.slice(c),a+r.R(g)):(g=r.$(t,c,i-1>c?i-1:c+10),a+r.R(g)+"\u2026")}function a(t){return Q.xr(t.t,t.title)}function c(t){var n=(t-Q.Rr)/18144e5;return n<0?0:n<1?n*n*.666667:n<1.000165?.666446:0}function _(t,n,e){var r=c(e),i=Q.xr(t,n);return r<=i?i:(i+r)/2}function g(t,n){return n}var v=0,h=null,S=false,p=false,B=0,U=0,y=0,b=0,w=0,T=0,k=[""],M="",x="",R="",C="",O=0,D=false,N=false,I="",E="",j=0,P=null,F=true,J=function(t,n,e,r,i,o){this.e=t,this.u=n,this.t=e,this.title=r,this.r=i(this,o),this.visit=0},V=performance,A={Or:[],Dr:[],Nr:null,Er:"",jr:0,Pr:0,Qt:function(t,n){if(0!==k.length&&1&j)2===A.Pr?A.Fr():A.Nr=t;else if(W.Jr([],1),n)return;0===A.Pr&&A.Vr()},Ar:function(t){return 47===t.charCodeAt(0)},Fr:function(){var t,e,r,i,o,l,s,f,a,c,_,m=k.some(A.Ar),d=!!Y.Lr,v=[],h=Y.$r&&Y.$r.Or||A.Or,S=h.length,p=[];for(e=0;e<S;e++)if(Q.qr((r=h[e]).t,m?r.Er:r.Kr)&&(F||r.Wr)){if(d&&v.push(r),E&&r.u.length<E.length+2&&E===(r.u.endsWith("/")?r.u.slice(0,-1):r.u))continue;p.push([-Q.xr(r.t,r.Kr),e])}for(d&&(Y.Lr.Or=v),w+=t=p.length,t?(p.sort(u),T>0&&!(6&j)?(p=p.slice(T,T+y),T=0):t>T+y&&(p.length=T+y)):j^=1,i=[],o=64&B?-.666446:0,l=0,s=p;l<s.length;l++)a=(f=s[l])[0],o&&(a=a<o?a:(a+o)/2),c=new J("bookm",(r=h[e=f[1]]).u,r.t,m?r.Er:r.Kr,g,-a),_=32&B&&X.zr?X.Qr(r.u):-1,c.visit=_<0?0:X.Gr[_].Hr,i.push(c),null!==r.Xr&&(c.u=r.Xr,c.title=n(m?r.Er:r.Kr),c.textSplit="javascript: \u2026",c.t=r.Zr);W.Jr(i,1)},Yr:function(){var t=chrome.bookmarks;t.onCreated.addListener(A.ti),t.onRemoved.addListener(A.ni),t.onChanged.addListener(A.ni),t.onMoved.addListener(A.ti),t.onImportBegan.addListener(function(){chrome.bookmarks.onCreated.removeListener(A.ti)}),t.onImportEnded.addListener(function(){var t=A.ti;chrome.bookmarks.onCreated.addListener(t),t()})},Vr:function(){A.Pr=1,A.Ur&&(clearTimeout(A.Ur),A.Ur=0),chrome.bookmarks.getTree(A.ei)},ei:function(t){A.Pr=2,A.Or=[],A.Dr=[],Y.Wt(2),t.forEach(A.ri,A);var n=A.Nr;if(A.Nr=null,setTimeout(function(){return nt.ii(A.Or)},50),A.Yr&&(setTimeout(A.Yr,0),A.Yr=null),n&&!n.o)return A.Fr()},ri:function(t){var n,e,i,o=t.title,u=t.id,l=A.Er+"/"+(o||u);if(t.children)return A.Dr.push(u),n=A.Er,2<++A.jr&&(A.Er=l),t.children.forEach(A.ri,A),--A.jr,void(A.Er=n);i=(e=t.url).startsWith("javascript:"),A.Or.push({oi:u,Er:l,Kr:o||u,t:i?"javascript:":e,Wr:P?Z.ui(e,o):1,u:i?"javascript:":e,Xr:i?e:null,Zr:i?r.W(e):null})},Ur:0,li:0,si:false,fi:function(){var t=V.now()-A.li;0===A.Pr&&(t>=6e4||t<-5e3?(A.Ur=A.li=0,A.si=false,A.Vr()):(A.Or=[],A.Dr=[],A.Ur=setTimeout(A.fi,3e4),Y.Wt(2)))},ti:function(){A.li=V.now(),A.Pr<2||(A.Ur=setTimeout(A.fi,6e4),A.Pr=0)},ni:function(t,n){for(var e,r,i,o,u,l,s,f=A.Or,a=f.length,c=n&&n.title,_=0;_<a&&f[_].oi!==t;_++);if(_<a)return r=(e=f[_]).u,i=n&&n.url,nt.ai&&(null==c?r!==e.t||!n:null!=i&&r!==i)&&nt.ci.has(r)&&X.zr&&X.Qr(r)<0&&nt.ci.delete(r),void(null!=c?(e.Er=e.Er.slice(0,-e.Kr.length)+(c||e.oi),e.Kr=c||e.oi,i&&(e.u=i,e.t=nt._i(i,e),nt.gi()),P&&(e.Wr=Z.ui(e.u,e.Kr))):(f.splice(_,1),n||A.ti()));if(!(A.Dr.indexOf(t)<0)){if(null!=c)return A.ti();if(!A.si&&nt.ai){for(o=nt.ci,u=X.Qr,l=0,s=X.zr?f:[];l<s.length;l++)o.has(r=s[l].u)&&u(r)<0&&o.delete(r);A.si=true}return A.ti()}}},L={Qt:function(t,n){var e,r,i,o,u,l;if(!k.length&&1024&B||!(2&j))return W.Jr([],2);if(r=k.length>0,e=X.Gr){if(r)return W.Jr(L.mi(e),2);(X.di>10||X.vi>0)&&X.hi()}else if(i=r?function(n){if(!t.o)return W.Jr(L.mi(n),2)}:null,r&&(p||X.Si)?(X.Si>0&&clearTimeout(X.Si),X.Si=0,X.pi(i)):(X.Si||(X.Si=setTimeout(function(){X.Si=0,X.pi(i)},r?200:150)),r&&W.Bi((l=(u=(o=W.Ui).length)>0)&&"search"===o[0].t?[o[0]]:[],S&&l,0,0,u,x,O)),r)return;S=false,0===n?W.yi(L.bi,t):chrome.sessions?chrome.sessions.getRecentlyClosed(L.wi.bind(L,t)):L.Ti([],t,new Set,0,0)},mi:function(t){var n,e,i,o,u=1===k.length?k[0]:"",l=u&&("."===u[0]?/^\.[\da-zA-Z]+$/.test(u):(r.K(u,null,-2),r.V<=2)),s=l?"."===u[0]||r.V>0?G.Tr[0]:(G.ki||G.Mi(),G.ki[0]):null,f=!(Y.$r&&Y.$r.Gr),a=Y.Lr?[]:null,m=[-1.1,-1.1],d=[],v=Q.qr,h=l&&u.includes("%")&&!/[^\x21-\x7e]|%[^A-F\da-f]/.test(u),S=y+T,p=-1.1,B=0,U=0,b=0;for(I&&S++,U=S;--U;)m.push(-1.1,-1.1);for(S=2*S-2,f||(t=Y.$r.Gr),n=t.length;B<n;B++)if(e=t[B],(l?s.test(h?e.u:e.t):v(e.t,e.Kr))&&(F||e.Wr)&&(a&&a.push(e),b++,(i=l?c(e.Hr)||1e-16*Math.max(0,e.Hr):_(e.t,e.Kr,e.Hr))>p)){for(U=S-2;0<=U&&m[U]<i;U-=2)m[U+2]=m[U],m[U+3]=m[U+1];m[U+2]=i,m[U+3]=B,p=m[S]}for(a&&(Y.Lr.Gr=a),w+=b,b||(j^=2),5&j?B=0:(B=2*T,T=0);B<=S&&!((i=m[B])<=0);B+=2)(e=t[m[B+1]]).u!==I&&((o=new J("history",e.u,h?e.u:e.t,e.Kr,g,i)).visit=e.Hr,d.push(o));return nt.gi(),d},bi:function(t,n){var e,r,i,o,u,l;if(Y.xi(n),!t.o){for(e=new Set,r=0,i=0,o=n;i<o.length;i++)(u=o[i]).incognito&&h||e.has(l=u.url||u.pendingUrl)||(e.add(l),r++);return L.Ti([],t,e,T,r)}},wi:function(t,n){var e,r,i;if(!t.o)return e=[],r=new Set,i=-T,n.some(function(t){var n,o,u,l=t.tab;return!!l&&((n=l.url).length>2e3&&(l.url=n=X.Ri(n,l)),!(!F&&!Z.ui(n,l.title))&&!r.has(o=n+"\n"+l.title)&&(r.add(o),r.add(n),++i>0&&e.push({u:l.url,Kr:l.title,Ci:(u=t.lastModified,u<3e11&&u>-4e10?1e3*u:u),Oi:l.sessionId}),e.length>=y))})?L.Di(e):L.Ti(e,t,r,-i,0)},Ti:function(t,n,e,r,i){chrome.history.search({text:"",maxResults:T+y*(F?1:2)+i},function(i){if(!n.o){i=i.filter(function(t){var n=t.url;return n.length>2e3&&(t.url=n=X.Ri(n,t)),!e.has(n)&&(F||0!==Z.ui(t.url,t.title||""))}),r<0?i.length=Math.min(i.length,y-t.length):r>0&&(i=i.slice(r,r+y));var o=i.map(function(t){return{u:t.url,Kr:t.title,Ci:t.lastVisitTime,Oi:null}});r<0&&(o=t.concat(o)),L.Di(o)}})},Di:function(t){t.forEach(L.Ni),T=0,nt.gi(),W.Jr(t,2)},Ni:function(t,n,e){var r=t.u,i=new J("history",r,nt._i(r,r),t.Kr||"",g,(99-n)/100),o=t.Oi;i.visit=t.Ci,o&&(i.s=o,i.label='<span class="undo">&#8630;</span>'),e[n]=i}},$={Qt:function(t,n){if(1!==k.length||!(16&j)||k[0].lastIndexOf("/",k[0].length-2)>=0)return W.Jr([],16);if(X.A);else{if(!X.Gr)return n>0?W.Jr([],16):X.pi(function(){if(!t.o)return $.Qt(t,0)});$.Vr(X.Gr)}return $.Fr()},Fr:function(){var t,n,e,i,o,u,l,s,f,a,c,g,m,d,v,h=r.A,p=Q.Ii,B=16===j&&S?[]:null,U=k[0].replace("/","").toLowerCase(),b=U===k[0],M=[],x="",R=-1.1;for(Q.Ii=3,i=h.keys(),o=void 0;!(o=i.next()).done;)(n=o.value).includes(U)&&(t=h.get(n),(F||t.Ei>0)&&(e=_(n,"",t.Hr),B?B.push({r:e,d:n,m:t}):e>R&&(R=e,x=n)));if(u=x.length===U.length,x&&!u&&(x.startsWith("www.")||x.startsWith(U)||(l=x.slice(x.indexOf(".")+1)).includes(U)&&(s=void 0,(s=h.get(l="www."+l))?(F||s.Ei>0)&&(x=l,t=s):(s=h.get(l="m."+l))&&(F||s.Ei>0)&&(F||s.Ei>0)&&(x=l,t=s)),(f=x.startsWith(U)?0:x.startsWith("www."+U)?4:-1)>=0&&(m=(c=(a=r.re(x))[0]).length-1,(g=a[1])>1&&(!(f=x.length-f-U.length-c[m].length-1)||3===g&&f===c[m-1].length+1)&&(u=true))),x)w++,S=!T&&u||S,M=$.ji(x,t,0,b);else if(B)for(B.sort($.Pi),(w=B.length)>T+y&&(B.length=T+y),d=0,v=B;d<v.length;d++)M.push($.ji((m=v[d]).d,m.m,m.r,b)[0]);Q.Ii=p,W.Jr(M,16)},ji:function(e,r,i,o){var u,l,s,f,a,c,_,m,d=r.te>0,v="";return 2===A.Pr&&(u=new RegExp("^https?://"+e.replace(H,"\\$&")+"/?$"),(l=A.Or.filter(function(t){return u.test(t.u)&&(F||t.Wr)})).length>0&&(s=l.filter(function(t){return"s"===t.u[4]}),E=(f=(l=(d=s.length>0)?s:l)[0].u).endsWith("/")?f.slice(0,-1):f,v=l[0].Kr)),a=(d?"https://":"http://")+e+"/",!i&&(I=a,T>0)?(T--,[]):(c=new J("domain",a,o?e:e+"/","",g,i||2),m=(_=X.zr?X.Qr(a):-1)>0?X.Gr[_]:null,t(c),m&&(F||m.Wr)&&(c.visit=m.Hr,v=v||m.Kr),c.title=n(v,[]),--y,[c])},Vr:function(t){var n,e,i,o,u,l,s,f,a,c,_;for($.Vr=null,n=$.Fi,e=X.A=r.A,i=0,o=t;i<o.length;i++)l=(u=o[i]).Hr,s=u.Wr,(f=n(u.u))&&(c=f.Ji,(_=e.get(a=f.Vi))?(_.Hr<l&&(_.Hr=l),_.Ei+=s,c>=7&&(_.te=8===c?1:0)):e.set(a,{Hr:l,Ei:s,te:8===c?1:0}))},Fi:function(t){var n,e,r=t.lastIndexOf(":",5),i=r>0?t.slice(0,r):"";if("http"===i)n=7;else if("https"===i)n=8;else{if("ftp"!==i)return null;n=6}return e=t.indexOf("/",n),{Vi:"__proto__"!==(t=t.slice(n,e<0?t.length:e))?t:".__proto__",Ji:n}},Pi:function(t,n){return n.r-t.r}},q={Qt:function(t,n){!(4&j)||n&&(!k.length||256&B)?W.Jr([],4):W.yi(q.Fr,t)},Fr:function(t,n){var e,i,o,u,s,c,_,g,d,v,S,U,M,x,R,C,O,D,I,E,P,F,V,A,L,$,K,z,H,G,X,Z,tt,et,rt,it,ot,ut,lt,st,ft,at,ct,_t;if(Y.xi(n),!t.o){if(e=m.mt,i=k.length<=0,o=3&j,s=[],(u=!!(8&B)&&N&&i&&!p)&&!(128&B)&&n.length>T&&n.length>b){for(c=new Map,_=0,g=n;_<g.length;_++)c.set((d=g[_]).id,d);for(M=(U=(S=(v=c.get(e))?v.openerTabId:0)?c.get(S):null)?U.index:v?v.index-1:0,x=U?0:b/2|0;1<--x&&M>0&&n[M-1].openerTabId===S;M--);n=M>0?n.slice(M).concat(n.slice(0,M)):n}for(R=[],C=[],O=!i&&/^:[a-z]+/gm.test(k.join("\n")),D=0,I=n;D<I.length;D++)d=I[D],!N&&h&&d.incognito||(E=d.url||d.pendingUrl,P=d.text||(d.text=nt._i(E,d.incognito?"":E)),F=d.title,O&&(1===k.length&&(P=F=""),d.audible&&(F+=" :audible :audio",F+=d.mutedInfo.muted?" :muted":" :unmuted"),d.discarded&&(F+=" :discarded"),d.incognito&&(F+=" :incognito"),d.pinned&&(F+=" :pinned")),(i||Q.qr(P,F))&&(V=d.windowId,!N&&C.lastIndexOf(V)<0&&C.push(V),R.push(d)));if(o&&1===R.length&&R[0].id===m.mt&&(R.length=0),w+=A=R.length,A||(j^=4),T>=A&&!o)return T=0,W.Jr(s,4);if(C.sort(q.Ai),L=i?u?q.Li:q.$i:a,$=u?r.T():null,K=C.length>1?m.ft:0,u)for(z=0,H=R;z<H.length;z++)$[(d=H[z]).id]=(X=(G=d.openerTabId)&&$[G])?X<5?X+1:5:1;for(Z=32&B?1===l.en.o?0:f<62?Date.now()-performance.now():performance.timeOrigin:0,tt=0;tt<R.length;)et=(d=R[tt++]).id,rt=u?$[et]:1,E=d.url||d.pendingUrl,it=m.Ot.get(et),ot=new J("tab",E,d.text,d.title,L,u?tt:et),ut=K&&d.windowId!==K?C.indexOf(d.windowId)+1+":":"",lt="",ut+=tt,e===et?(u||(ot.r=i?1<<31:0),ut="("+ut+")"):it||(ut="**"+ut+"**"),!h&&d.incognito&&(lt+="*"),d.discarded&&(lt+="~"),d.audible&&(lt+=d.mutedInfo.muted?"\u266a":"\u266c"),ot.visit=it?it.t+Z:0,ot.s=et,ot.label="#"+ut+(lt&&" "+lt),rt>1&&(ot.level=" level-"+rt),s.push(ot);if(s.sort(W.qi),ft=T+y-(st=s.length),o||ft<0||!i)for(T>0&&!o?(s=s.slice(T,T+y),st=y,T=0):st>T+y&&(s.length=st=T+y),x=o?0:st;x<st;x++)s[x].r*=8/(x/4+1);else if(T>0){for(ct=0,_t=at=s.slice(0,ft);ct<_t.length;ct++)_t[ct].label+="[r]";for(st=(s=s.slice(T).concat(at)).length,x=0;x<st;x++)s[x].r=st-x;T=0}nt.gi(),W.Jr(s,4)}},Ai:function(t,n){return t-n},$i:function(t,n){var e=m.Ot.get(n);return e?e.i:4&B?2047+n:-n},Li:function(t,n){return 1/n}},K={me:0,Qt:r.w,Ki:function(t,n){var e,i,o,u,s,f,a,c,_,g;if(!(8&j))return W.Jr([],8);if(o=(i=k).length>0?i[0]:"",0===i.length);else{if(true!==n&&"\\"===o[0]&&"\\"!==o[1])return o.length>1?i[0]=o.slice(1):i.shift(),o=R.slice(1).trimLeft(),F=!P||F||Z.Wi([o]),T?(T--,W.Jr([],8)):(e=K.zi(o),W.Jr([e],8));u=l.le.searchEngineMap.get(o)}if(true===n){if(!u)return true}else{if(!u&&!o.startsWith("vimium://"))return 0===v&&i.length<=1&&(v=i.length?K.Qi():-1),W.Jr([],8);u&&C&&(i.push(C),T=0,R+=" "+C,C="",O&=-5),i.length>1||(v=-1)}if(i.length>1&&u?(i.shift(),R.length>200&&(i=R.split(" ")).shift()):u&&(i=[]),F=!P||F&&Z.Wi([o]),u?(a=s=(c=r.ye(i,u.xe,u.w,[])).xe,f=c.Se):(a=s=i.join(" "),f=[]),"~"===o);else if(s.startsWith("vimium://")){if(_=r.J(s.slice(9),1,true),g=K.Hi.bind(K,i,s,a,u,f),_ instanceof Promise)return _.then(K.Gi.bind(K,t,g));if(_ instanceof Array)return K.Gi(t,g,_);_&&(s=a=_,f=[])}else s=r.K(s,null,-2);return e=K.Hi(i,s,a,u,f),W.Jr([e],8)},Gi:function(t,n,e){var i,o,u,l,s;if(!t.o){switch(e[1]){case 5:case 6:if(v=6===e[1]&&k.length>1?v:-1,!(o=e[0]))break;return C="",(k=((R="\\ "+o).length<201?R:r.$(R,0,200).trim()).split(" ")).length>1&&(k[1]=r.$e(k[1],k.length>2)),K.Ki(t);case 2:if(k=(u=e[0]).length>1||1===u.length&&u[0]?u:k,(l=K.me++)>12)break;if(s=K.Ki(t,true),l<=0&&(K.me=0),true!==s)return s;break;case 0:e[0]&&(i=K.Xi(n(),e))}W.Jr(i||[n()],8)}},Hi:function(t,o,u,l,s){var f=new J("search",o,u,(l?l.qe+": ":"")+t.join(" "),g,9);return t.length>0&&l?(f.t=K.Zi(u,s),f.title=n(f.title,[l.qe.length+2,f.title.length]),f.textSplit=e(f.t,s)):(f.t=r.W(i(u)),f.title=n(f.title,[]),f.textSplit=r.R(f.t)),p||(f.v=l&&l.w||K.a(o)),f.p=l?l.qe:"",f},Xi:function(t,e){var i=e[0],o=new J("math","vimium://copy "+i,i,i,g,9);return--o.r,o.title='<match style="text-decoration: none;">'+n(o.title,[])+"<match>",o.textSplit=r.R(e[2]),[t,o]},a:function(t){for(var n=X.zr&&t.startsWith("http")?X.Qr(t):-1,e=n<0?~n-1:n,r=e<0?[]:X.Gr,i=t.indexOf(":")+3,o=0,u=0,l="",s="",f=0,a=0;o<=e&&(i="/"===t[i]?i+1:t.indexOf("/",i+1)+(u?0:1))>0;u=i){for(l=t.slice(u,i),a=e;o<=a;)if((s=r[f=o+a>>>1].u.slice(u))>l)a=f-1;else{if(s===l)return u?r[f].u:"";o=f+1}if(o<=e&&u&&"/"===(l=r[o].u)[i]&&l.length<=++i)return l}return""},Yi:0,mr:0,Qi:function(){var t=k[0],n=l.le.searchKeywords;return null==n?(K.mr=K.mr||setTimeout(K.fo,67),-2):t.length>=K.Yi?0:n.includes("\n"+t)?-2:0},Zi:function(t,n){var e,i,o,u=n.length;if(i=r.W(n.length>0?t.slice(0,n[0]):t),(e=r.Me(i))&&(i=i.slice(e),e=0),n.length<=0)return i;for(o=n[0];n[e]=i.length,u>++e;)i+=r.W(t.slice(o,n[e])),o=n[e];return o<t.length&&(i+=r.W(t.slice(o))),i},zi:function(t){var e=r.K(t,null,-2),o=4===r.V,u=new J("search",e,r.W(i(e)),"",g,9);return u.title=o?"~: "+n(t,[0,t.length]):n(t,[]),u.textSplit=r.R(u.t),p||(u.v=K.a(e)),u.p=o?"~":"",u.n=1,u},fo:function(){var t,n,e,i=r.b(l.le.searchEngineMap).sort(),o=0,u="",s=[];for(t=i.length;0<=--t;)u.startsWith(n=i[t])||(o=(e=n.length)>o?e:o,u=n,s.push(n));l.in("searchKeywords","\n"+s.join("\n")),K.Yi=o,K.mr=0}},W={_o:0,go:0,Ui:null,vo:null,Bi:null,Qt:function(t){var n,e,r,i;if(W.vo&&(W.vo.o=true),n=W.vo={o:false},W.go=0,e=1,r=-9&(j&=t[0])?t.length:2,W.Ui=[],W._o=r-1,v=T&&-1,t[1]===K){if(i=K.Ki(n),r<3)return;if(i)return void i.then(W.ho.bind(null,t,n,e));e=2}W.ho(t,n,e)},ho:function(t,n,e){for(Q.Rr=Date.now()-18144e5,Q.Ii=3*k.length||.01,k.indexOf("__proto__")>=0&&(k=k.join(" ").replace(/(^| )__proto__(?=$| )/g," __proto_").trimLeft().split(" ")),Y.Ir(),k.sort(W.So),G.Bo();e<t.length;e++)t[e].Qt(n,e-1)},So:function(t,n){return n.length-t.length||(t<n?-1:t===n?0:1)},yi:function(t,n,e){var r,i=m.dt;null===h&&(i=1!==i?i:f>=52||l.E.Un||!!Y.Ot.Ot?m.dt=0:1),1!==i?(Y.Ot.Uo!==(r=((h=2!==i)?2:0)|(N?1:0))&&(Y.Ot={Ot:null,Uo:r}),(e=e||Y.Ot.Ot)?t(n,e):chrome.tabs.query(N?{currentWindow:true}:{},t.bind(null,n))):chrome.windows.getCurrent({populate:N},function(e){m.dt=h?0:2,n.o||W.yi(t,n,N?e.tabs:null)})},Jr:function(t,n){var e=W.Ui,r=t.length;if(r>0&&(W.go|=n,W.Ui=0===e.length?t:e.concat(t),8===n&&(S=!0,y-=r,w+=r)),0==--W._o)return e=null,W.yo()},yo:function(){var n,e,r,o,u,l,s,f,a,c,_,g,m=W.Ui;return W.Ui=null,m.sort(W.qi),T>0?(m=m.slice(T,T+b),T=0):m.length>b&&(m.length=b),G.bo=G.ki=null,k.length>0&&(e=i(n=k[0]),((r=n.length!==e.length)||n.endsWith("/")&&n.length>1&&!n.endsWith("//"))&&(k[0]=r?e:n.slice(0,-1),G.wo())),m.forEach(t),o=m.length>0,u=S&&o,l=w,s=":"===M,a=x,c=O,_=2!=(f=v<0?-2!==v||o||s?0:3:F?k.length<=0||D?0:o?2:s?0:1:0)||s?0:W.go,g=W.Bi,W.To(),g(m,u,f,_,l,a,c)},To:function(){W.vo=W.Bi=h=null,k=[],M=x=R=C=I=E="",G.Tr=null,Q.Ii=3,Q.Rr=v=W.go=B=y=b=w=U=0,j=0,O=0,S=p=false,D=N=false,F=true},ko:function(){var t,n,e=R;if(T=0,C="",!(0===e.length||(t=(e=e.slice(-5)).lastIndexOf("+"))<0||0!==t&&32!==e.charCodeAt(t-1))){if(e=e.slice(t),t=R.length-e.length,(n=parseInt(e,10))>=0&&"+"+n===e&&n<=(t>0?100:200))T=n;else if("+"!==e)return;R=R.slice(0,t&&t-1),C=e,O|=4}},qi:function(t,n){return n.r-t.r}},z={__proto__:null,bookm:[1,A],domain:[16,$],history:[2,L],omni:[63,K,$,L,A,q],search:[8,K],tab:[4,q]},Q={qr:function(t,n){var e,r,i=G.Tr;for(e=0,r=k.length;e<r;e++)if(!(i[e].test(t)||i[e].test(n)))return false;return true},Ii:3,Mo:[0,0],xo:function(t,n){var e,r=0;return(e=n.split(G.Tr[t]).length)<1?Q.Mo:(r=1,G.ki[t].test(n)&&(r+=1,G.bo[t].test(n)&&(r+=1)),[r,(e-1)*k[t].length])},xr:function(t,n){var e,r,i,o=0,u=0,l=0,s=0,f=!!n;for(G.ki||G.Mi(),e=0,r=k.length;e<r;e++)s+=(i=Q.xo(e,t))[0],l+=i[1],f&&(u+=(i=Q.xo(e,n))[0],o+=i[1]);return s=s/Q.Ii*Q.Ro(l,t.length),0===o?n?s/2:s:s<(u=u/Q.Ii*Q.Ro(o,n.length))?u:(s+u)/2},Rr:0,Ro:function(t,n){return t<n?t/n:n/t}},H=/[$()*+.?\[\\\]\^{|}]/g,G={Tr:null,ki:null,bo:null,Bo:function(){var t,n,e,r=G.Tr=[];for(G.ki=G.bo=null,t=0,n=k;t<n.length;t++)e=n[t],r.push(new RegExp(e.replace(H,"\\$&"),e!==e.toUpperCase()&&e.toLowerCase()===e?"i":""))},Mi:function(){var t,n,e,r,i,o=G.ki=[],u=G.bo=[];for(t=0,n=G.Tr;t<n.length;t++)r="\\b"+(e=n[t]).source,i=e.flags,o.push(new RegExp(r,i)),u.push(new RegExp(r+"\\b",i))},wo:function(){G.Tr&&(G.Tr[0]=new RegExp(k[0].replace(H,"\\$&"),G.Tr[0].flags))}},X={Co:0,di:0,vi:0,zr:false,Si:0,Gr:null,Oo:null,A:null,pi:function(t){X.Oo?t&&X.Oo.push(t):(X.Oo=t?[t]:[],X.Co=Date.now(),X.Si||chrome.history.search({text:"",maxResults:2e4,startTime:0},function(t){setTimeout(X.Do,0,t)}))},Do:function(t){var n,e,r,i,o,u,l;for(X.Do=null,n=0,e=t.length;n<e;n++)(i=(r=t[n]).url).length>2e3&&(i=X.Ri(i,r)),t[n]={t:i,Kr:r.title,Hr:r.lastVisitTime,Wr:1,u:i};if(P)for(o=0,u=t;o<u.length;o++)0===Z.ui((l=u[o]).t,l.Kr)&&(l.Wr=0);setTimeout(function(){setTimeout(function(){var t,n,e,r,i,o,u,l,s=X.Gr;for(t=s.length-1;0<t;)for(i=(r=(n=s[t]).t=nt._i(e=n.u,n)).length>=e.length;0<=--t&&!((u=(o=s[t]).u).length>=e.length)&&e.startsWith(u);)o.u=e.slice(0,u.length),l=i?u:nt._i(u,o),o.t=i||l.length<u.length?r.slice(0,l.length):l;X.A||setTimeout(function(){$.Vr&&$.Vr(X.Gr)},200)},100),X.Gr.sort(function(t,n){return t.u>n.u?1:-1}),X.zr=true,chrome.history.onVisitRemoved.addListener(X.No),chrome.history.onVisited.addListener(X.Io)},100),X.Gr=t,X.pi=function(t){t&&t(X.Gr)},X.Oo&&X.Oo.length>0&&setTimeout(function(t){var n,e;for(n=0,e=t;n<e.length;n++)(0,e[n])(X.Gr)},1,X.Oo),X.Oo=null},Io:function(t){var n,e,r,i,o,u,l,s,f,a=t.url;if(a.length>2e3&&(a=X.Ri(a,t)),n=t.lastVisitTime,e=t.title,r=++X.di,i=X.A,(o=X.Qr(a))<0&&X.vi++,(r>59||r>10&&Date.now()-X.Co>3e5)&&X.hi(),u=o>=0?X.Gr[o]:{t:"",Kr:e,Hr:n,Wr:P?Z.ui(a,e):1,u:a},i&&(s=$.Fi(a))&&((l=i.get(s.Vi))?(l.Hr=n,o<0&&(l.Ei+=u.Wr),s.Ji>=7&&(l.te=8===s.Ji?1:0)):i.set(s.Vi,{Hr:n,Ei:u.Wr,te:8===s.Ji?1:0})),o>=0)return u.Hr=n,void(e&&e!==u.Kr&&(u.Kr=e,Y.mr&&Y.Wt(1),P&&(f=Z.ui(a,e),u.Wr!==f&&(u.Wr=f,l&&(l.Ei+=f||-1)))));u.t=nt._i(a,u),X.Gr.splice(~o,0,u),Y.mr&&Y.Wt(1)},No:function(t){var n,e,i,o,u,l,s,f,a,c,_,g,m;if(nt.Eo.length=0,n=nt.ci,Y.Wt(1),t.allHistory){for(X.Gr=[],X.A&&(X.A=r.A=new Map),e=new Map,i=0,o=A.Or;i<o.length;i++)n.delete((u=o[i]).u);nt.ci=e}else for(l=X.Qr,s=X.Gr,f=X.A,c=0,_=t.urls;c<_.length;c++)(u=l(g=_[c]))>=0&&(f&&s[u].Wr&&(m=$.Fi(g))&&(a=f.get(m.Vi))&&--a.Ei<=0&&f.delete(m.Vi),s.splice(u,1),n.delete(g))},Ri:function(t,n){var e=t.lastIndexOf(":",9),i=e>0&&"://"===t.substr(e,3),o=n.title;return t=t.slice(0,(i?t.indexOf("/",e+4):e)+320)+"\u2026",o&&o.length>160&&(n.title=r.$(o,0,160)),t},hi:function(){var t=Date.now();if(X.vi<=0);else{if(t<X.Co+1e3&&t>=X.Co)return;setTimeout(chrome.history.search,50,{text:"",maxResults:Math.min(999,X.di+10),startTime:t<X.Co?t-3e5:X.Co},X.jo)}return X.Co=t,X.vi=X.di=0,nt.gi()},jo:function(t){var n,e,r,i,o,u,l=X.Gr,s=X.Qr;if(!(l.length<=0))for(n=0,e=t;n<e.length;n++){if((i=(r=e[n]).url).length>2e3&&(r.url=i=X.Ri(i,r)),(o=s(i))<0)X.vi--;else if(!(u=r.title)||u===l[o].Kr)continue;X.di--,X.Io(r)}},Qr:function(t){for(var n="",e=X.Gr,r=e.length-1,i=0,o=0;i<=r;)if((n=e[o=i+r>>>1].u)>t)r=o-1;else{if(n===t)return o;i=o+1}return~i}},Z={ui:function(t,n){var e,r,i;for(e=0,r=P;e<r.length;e++)if(n.includes(i=r[e])||t.includes(i))return 0;return 1},Wi:function(t){var n,e,r,i,o,u;if(P)for(n=0,e=t;n<e.length;n++)for(r=e[n],i=0,o=P;i<o.length;i++)if(u=(u=o[i]).trim(),r.includes(u)||u.length>9&&r.length+2>=u.length&&u.includes(r))return true;return false},Po:function(){var t,n,e,r,i,o,u,l,s;if(A.Or)for(t=0,n=A.Or;t<n.length;t++)(e=n[t]).Wr=P?Z.ui(e.t,e.Er):1;if(X.Gr)for(r=X.A,i=0,o=X.Gr;i<o.length;i++)e=o[i],u=P?Z.ui(e.t,e.Kr):1,e.Wr!==u&&(e.Wr=u,r&&(l=$.Fi(e.u))&&(s=r.get(l.Vi))&&(s.Ei+=u||-1))},Fo:function(t){var n,e,r,i=[];for(n=0,e=t.split("\n");n<e.length;n++)(r=e[n]).trim()&&"#"!==r[0]&&i.push(r);P=i.length>0?i:null,(X.Gr||A.Or)&&setTimeout(Z.Po,100)}},Y={$r:null,Lr:null,Ot:{Ot:null,Uo:0},Jo:[],mr:0,Vo:0,Ir:function(){var t,n,e,r,i,o=k,u=null,s=0,f=o.join(" ");for(t=Y.Jo,n=f?t.length:0;0<=--n;)if(t[n].Ao||!F){for(e=t[n].Rt,r=0,i=0;r<e.length&&i<o.length;i++)o[i].includes(e[r])&&r++;if(r>=e.length){u=t[n];break}}Y.$r=u,u&&(l.nn.t<200||!u.Gr||u.Gr.length>1e3)&&(s=V.now())-u.Hr<Math.max(300,1.3*l.nn.t)?(Y.Lr=u,u.Rt=o.slice(0)):!f||u&&f===u.Rt.join(" ")||!(f.length>4||/\w\S|[^\x00-\x80]/.test(f))?Y.Lr=null:(Y.Lr={Rt:o.slice(0),Ao:F,Hr:s||V.now(),Gr:u&&u.Gr,Or:u&&u.Or},Y.Jo.push(Y.Lr),Y.mr||(Y.mr=setInterval(Y.Lo,6e3)))},Lo:function(){for(var t=Y.Jo,n=-1,e=V.now()-5983;++n<t.length&&t[n].Hr<e;);++n<t.length?t.splice(0,n):(t.length=0,clearInterval(Y.mr),Y.mr=0)},Wt:function(t){var n,e,r;for(n=0,e=Y.Jo;n<e.length;n++)r=e[n],t<2?r.Gr=null:t<3?r.Or=null:Y.Ot.Ot=null},xi:function(t){Y.Ot.Ot!==t&&(Y.Vo&&(clearTimeout(Y.Vo),Y.Vo=0),Y.Ot.Ot=t,t&&(Y.Vo=setTimeout(Y.xi,3e3,null)))}},tt=decodeURIComponent,nt={_i:function(t,n){if(t.length>=400||t.lastIndexOf("%")<0)return t;try{return tt(t)}catch(t){}return nt.ci.get(t)||(n&&nt.Eo.push(n),t)},ii:function(t){for(var n,e,r=nt.ci,i=nt.Eo,o=-1,u=t.length;;)try{for(;++o<u;)(n=t[o]).t=(e=n.u).length>=400||e.lastIndexOf("%")<0?e:tt(e);break}catch(t){n.t=r.get(e)||(i.push(n),e)}nt.gi()},ci:new Map,Eo:[],$o:-1,gi:function(){0!==nt.Eo.length&&-1===nt.$o&&(nt.$o=0,setTimeout(nt.qo,17,null))},qo:function(t){for(var n,e,r,i,o,u,l;nt.$o<nt.Eo.length;nt.$o++){if(!(n=nt.ci.get(i=(r="string"==typeof(e=nt.Eo[nt.$o]))?e:e.u)))return t||(t=nt.Ko())?(l=(u=(o=f>=66?i.split("#",3):[]).length)<2?i:u<3?o[0]+"%23"+o[1]:i.replace(/#/g,"%23"),t.open("GET",nt.Wo+l,true),t.send()):(nt.Eo.length=0,void(nt.$o=-1));r||(e.t=n)}},zo:function(){if(!(nt.$o<0)){var t=this.responseText,n=nt.Eo[nt.$o++];"string"!=typeof n?nt.ci.set(n.u,n.t=t):nt.ci.set(n,t),nt.$o<nt.Eo.length?nt.qo(this):(nt.Eo.length=0,nt.$o=-1)}},ai:true,Wo:"1",Ko:function(){if(!nt.Wo)return null;var t=new XMLHttpRequest;return t.responseType="text",t.onload=nt.zo,t},Qo:function(t){var n=!!t&&!(t=t.toLowerCase()).startsWith("utf"),e=n?"data:text/plain;charset="+t+",":"",i=nt.Wo;e!==i&&(nt.Wo=e,n?"1"!==i&&setTimeout(function(){return X.Gr&&nt.ii(X.Gr),nt.ii(A.Or)},100):(nt.ci.clear(),nt.Eo.length=0),nt.ai!==n&&(nt.Eo=n?[]:{length:0,push:r.w},nt.ai=n,nt.$o=-1))}};d={Qt:function(t,n,e){var i,o,u,l,s,f;S=false,M=R=(t=t.trim())&&t.replace(r.F," "),x="",O=0,W.ko(),k=(t=R)?(t=t.length<201?t:r.$(t,0,200).trimRight()).split(" "):[],(U=0|n.c||128)&&(U-=t.replace(/[\u2e80-\u2eff\u2f00-\u2fdf\u3000-\u303f\u31c0-\u31ef\u3200-\u9fbf\uf900-\ufaff\ufe30-\ufe4f\uff00-\uffef]/g,"aa").length-t.length),U=Math.max(50,Math.min(U,320)),p=!!(1&(B=n.f)),b=y=Math.min(Math.max(3,0|n.r||10),25),w=0,W.Bi=e,i="bomni"===n.o?(B|=64,z.omni):z[n.o],u=n.t||63,l=n.e||63,i===z.tab&&(N=!!(2&B)),S=1===i.length,2===(o=k.length>=1?k[0]:"").length&&":"===o[0]&&(s="b"===(o=o[1])?z.bookm:"h"===o?z.history:"t"===o||"w"===o||"W"===o?(N="t"!==o,B|=0,z.tab):"B"===o?(B|=64,z.omni):"H"===o?(B|=256,z.omni):"d"===o?z.domain:"s"===o?z.search:"o"===o?z.omni:null)&&(S=2===(i=s).length,x=k.shift(),O|=1,R=R.slice(3),l=i[0]),k.length>0&&((o=k[0]).includes("\u3002")||o.includes("\uff1a"))&&(D=k.length<2,(f=r.$e(o,D))!==o?(k[0]=f,R=f+R.slice(o.length),D=D&&!/^[.\u3002](\w+[.\u3002]?)*$/.test(o)):D=D&&o.includes("\uff1a")&&!/\uff1a([^\/\d]|\d[^\0-\xff])/.test(o)),F=!P||Z.Wi(k),j=u&l,R&&(O|=2),W.Qt(i)},Yt:function(t,n,e){switch(n){case"tab":chrome.tabs.remove(+t,function(){var t=r.S();return t||Y.xi(null),e(!t),t});break;case"history":var i=!X.zr||X.Qr(t)>=0;chrome.history.deleteUrl({url:t}),i&&Y.Wt(1),e(i)}},Mr:function(){Y.Ot.Ot&&(1&Y.Ot.Uo||!(2&Y.Ot.Uo)!=(2===m.dt))&&Y.xi(null)},Ho:Z.Wi},l.pn.omniBlockList=Z.Fo,l.hn("omniBlockList"),l.pn.localeEncoding=nt.Qo,l.hn("localeEncoding"),r.Oe(80,function(){l.hn("searchEngines",null)})});var d={Qt:function(t,n,e){r.Oe(210,function(){return d.Qt(t,n,e)})},Yt:r.w,Mr:r.w};r.Oe(1e3,function(){var t,n,e,i,o,u,s,f,a,c,_,g,m,d=r.M({findModeRawQueryList:1,innerCSS:1,keyboard:1,newTabUrl_f:1,vomnibarPage_f:1}),v=null,h="",S=null,p=null,B=null,U=function(){return t||(t=chrome.storage&&chrome.storage.sync)},y=function(t){b(t,"sync")},b=function(t,n){var e,i,o,u;if("sync"===n){if(e=function(t){var n,e,i,o;if(S){for(n in r.M(t),S)!(i=(e=n.split(":")[0])===n)&&e in S||T(e,null!=(o=i?S[n]:null)?o.newValue:t[e],t);S=null}},r.M(t),i=l.zn&&l.zn())return S&&r.h(t,S),S=t,void i.then(function(){return b({},n)});for(o in S&&(r.h(t,S),S=null),t){if(u=t[o],8===(o.includes(":")?8:T(o,null!=u?u.newValue:null)))return S=t,void U().get(e);delete t[o]}}},w=function(){var t,n=[];for(t=0;t<arguments.length;t++)n[t]=arguments[t];console.log.apply(console,[(new Date).toLocaleString()].concat.call([].slice.call(arguments,0)))},T=function(t,n,e){var r,i,o,u,f,a;if(t in l.sn&&!(t in l.cn)&&c(t)){if(r=l.sn[t],i=n&&"object"==typeof n&&n.$_serialize||""){if("split"===i&&!e)return 8;if(8===(n=s(t,n,e)))return}null!=n?(o=B?r:l.rn(t),(a="object"!=typeof r)?(f=n,u=o):(f=JSON.stringify(n),u=JSON.stringify(o)),f!==u&&(f===(o=a?r:JSON.stringify(r))&&(n=r),B||w("sync.this: update",t,"string"==typeof n?(n.length>32?n.slice(0,30)+"...":n).replace(/\n/g,"\\n"):n),k(t,n))):null!=localStorage.getItem(t)&&(B||w("sync.this: reset",t),k(t,r))}},k=function(t,n){var e="keyMappings"===t||"exclusionRules"===t?"KeyMappings":"";if(!e)return M(t,n);r.pe(e).then(M.bind(null,t,n)),r.De()},M=function(t,n){h=t,l.in(t,n),h="",t in l.un&&l.fn({N:6,d:[l.un[t]]})},x=function(t,n){c(t)&&t!==h&&(v||(setTimeout(a,800),v=r.T()),v[t]=n)};if(e=function(t,n){var e,i,o;U()?(i=chrome.storage.local,o=function(){var n=r.S();if(n)return w("storage.local: Failed to update",t,":",n.message||n),n},null==n?i.remove(t,o):i.set(((e={})[t]=n,e),o)):l.ln=r.w},i=function(t){return t.replace(/[<`\u2028\u2029]/g,function(t){return"<"===t?"`l":"`"===t?"`d":"\u2028"===t?"`r":"`n"})},o=function(t){return t.replace(/"|\\[\\"]/g,function(t){return'"'===t?"`q":'\\"'===t?"`Q":"`S"})},u=function(t){var n={Q:'\\"',S:"\\\\",d:"`",l:"<",n:"\u2029",q:'"',r:"\u2028"};return t.replace(/`[QSdlnqr]/g,function(t){return n[t[1]]})},s=function(t,n,e){var r,i,o,s,f="";switch(n.$_serialize){case"split":for(r=n.k,i=n.s,o=0;o<i;o++){if(!(s=e[t+":"+o])||!s.startsWith(r))return 8;f+=s.slice(r.length)}break;case"single":return JSON.parse(u(JSON.stringify(n.d)));default:return w("Error: can not support the data format in synced settings data:",t,":",n.$_serialize),null}return"string"==typeof l.sn[t]?f=u(f):(f=u(JSON.stringify(f)),JSON.parse(f.slice(1,-1)))},f=function(t,n,e){var r,u,s,f,a,c,_,g,m,d,v,h;if(n&&!("string"!=typeof n?"object"!=typeof n:n.length<8192/6-40)&&(u="",!((r=JSON.stringify(n)).length<8192/6-40))){if(4*(r=i(r)).length<8093)return r;if((u=e.encode(r)).length<8093)return r;for(s=0,f=Date.now().toString(36)+":",a={},r="string"==typeof l.sn[t]?r.slice(1,-1):o(r),p||(p=new TextDecoder),c=0,_=(u=e.encode(r)).length;c<_;){for(g=Math.min(c+8134,_),m=void 0,d=0;g<_&&128==(192&u[g]);g--);if((d=(r=(m=p.decode(u.subarray(c,g))).slice(-6)).lastIndexOf("\\"))>r.length-2)m+="b",d=1;else if(d>0&&"u"===r[d+1])for(v=d=r.length-d;v++<6;m+="b");else d=0;if(m=JSON.parse('"'+m+'"'),d&&((h=m.endsWith("b"))||(g-=d),m=m.slice(0,d>1&&h?d-6:-1)),a[t+":"+s++]=f+m,c=g,s>=13)break}return a[t]={$_serialize:"split",k:f,s:s},a}},a=function(){var t,n,e,i,o,u,s,a,c=v,_=[],g=[],m=[],d=r.T(),h={};if(v=null,c&&l.ln===x){for(n in t=new TextEncoder,c)for(i=c[e=n],u="string"==typeof(o=l.sn[e])||"object"==typeof o&&"vimSync"!==e?0:13,null!=i?(s=f(e,i,t))&&"object"==typeof s?(d[e]=s,u=s[e].s):(h[e]=s?{$_serialize:"single",d:JSON.parse(s)}:i,g.push(e)):(m.push(e),_.push(e));u<13;u++)m.push(e+":"+u);for(e in p=t=null,_.length>0&&w("sync.cloud: reset",_.join(", ")),m.length>0&&U().remove(m),g.length>0&&(w("sync.cloud: update",g.join(", ")),U().set(h)),a=function(t){U().set(d[t],function(){var n=r.S();return n?w("Failed to update",t,":",n.message||n):w("sync.cloud: update (serialized) "+t),n})},d)a(e)}},c=function(t){return!(t in d)},_=function(t){l.He.Be=null,r.Oe(t,function(){chrome.storage.local.get(function(t){var n,i,o,u,s,f,a,_,g;if(!l.rn("vimSync")&&localStorage.length){for(w("storage.local: backup all settings from localStorage"),r.M(t),n=0,i=localStorage.length;n<i;n++)(o=localStorage.key(n))in l.sn&&(c(o)||"keyboard"===o)&&(u=l.sn[o],s=t[o],a=f=l.rn(o),_=s,"object"==typeof u&&(_=JSON.stringify(s),a=JSON.stringify(f)),a!==_&&e(o,f),delete t[o]);(g=Object.keys(t)).length>0&&chrome.storage.local.remove(g)}})})},g=function(t,i,o){var u,s,f,a,_,g,m,d,v,S,p,y,k,M;if(2&i&&chrome.storage.local.get(function(t){var n,e,u,s,f=r.S();if(f)return l.zn=null,(i-=2)||o(),f;for(u in r.M(t),e=void 0!==(n=t.vimSync)||Object.keys(t).length>0,delete t.vimSync,e&&w("storage.local: restore settings to localStorage"),t)u in l.sn&&(h=u,s=null==(s=t[u])?l.sn[u]:s,l.in(u,s));h="",null!=n&&l.in("vimSync",n),r.Oe(100,function(){l.fn({N:6,d:l.en})}),(i-=2)||o()}),2!==i){if(r.M(t),!(u=t.vimSync||l.rn("vimSync")))return n=u,l.ln=e,void(--i||o());for(f in t.vimSync||(w("sync.cloud: enable vimSync"),t.vimSync=u,U().set({vimSync:u})),s=[],t)f in l.Sn&&s.push(f);for(a=[],_={},g=0,m=s;g<m.length;g++)for(f=m[g],d=l.Sn[f],v=-1,S=void 0;v<13&&(S=v<0?f:f+":"+v)in t;v++)_[p=v<0?d:d+":"+v]=t[p]=t[S],delete t[S],a.push(S);for(s.length>0&&(chrome.storage.onChanged.removeListener(b),l.ln=r.w,U().remove(a),U().set(_,r.S),s.length=0),v=0,y=localStorage.length;v<y;v++)!((f=localStorage.key(v))in t)&&f in l.sn&&c(f)&&s.push(f);for(k=0,M=s;k<M.length;k++)T(f=M[k],null);for(f in t)f.includes(":")||T(f,t[f],t);l.hn("vimSync"),r.Oe(4,function(){--i||o()}),B&&w("sync.cloud: download settings to localStorage")}},l.pn.vimSync=function(t){var r,i,o;if(n=t,U()){if(i=(r=U().onChanged)||chrome.storage.onChanged,o=r?y:b,!t)return i.removeListener(o),void(l.ln!==e&&(l.ln=e,_(600)));l.ln!==x&&(i.addListener(o),l.ln=x,chrome.storage.local.clear())}},l.zn=function(){if(B);else{if(localStorage.length)return null;r.De(),B=r.pe("KeyMappings").then(function(){return new Promise(function(t){n?U().get(function(n){var e=r.S();return e?(l.zn=null,t()):g(n,1,t),e}):g({},2,t)})}).then(function(){B=null})}return B},false===(n=l.rn("vimSync"))||!n&&!l.He.Ge)return m=l.He.Be,l.He.Be=m?null:_,m&&_(6e3),void(l.ln=e);r.De(),U()?U().get(function(t){var n=r.S();if(n)return w("Error: failed to get storage:",n,"\n\tSo disable syncing temporarily."),l.pn.vimSync=l.ln=r.w,l.zn=null,n;B=Promise.resolve(),B=new Promise(function(n){return g(t,3,n)}).then(function(){B=null})}):l.zn=null}),r.Oe(150,function(){var t,e,i,o,u=chrome.browserAction;u&&(i=l.pn.showActionIcon,o=function(n){var i=l.$n[n];fetch(i).then(function(t){return t.arrayBuffer()}).then(function(i){var o,u,l,s=new Uint8ClampedArray(i),f=i.byteLength/5,c=0|Math.sqrt(f/4),_=c+c,g=r.T();for(g[c]=new ImageData(s.subarray(0,f),c,c),g[_]=new ImageData(s.subarray(f),_,_),t[n]=g,o=e.get(n),e.delete(n),u=0,l=o.length;u<l;u++)a.lt(o[u],n,true)})},l.He.Qe=function(n){var r,i,o;if(null==n)return!!t;if(n){if(!t)for(i in t=[null,null,null],e=new Map,r=a.dn())0!==(o=r[+i][0].s).s&&a.lt(o.t,o.s)}else t&&setTimeout(function(){l.rn("showActionIcon")||(t=null,e=null)},200)},a.lt=function(n,i,l){var s,f,a;(s=t[i])?(f=u.setIcon,a={tabId:n,imageData:s},l?f(a,r.S):f(a)):e.has(i)?e.get(i).push(n):(setTimeout(o,0,i),e.set(i,[n]))},l.pn.showActionIcon=function(t){i(t),l.He.Qe(t);var e=n("name");t||(e+="\n\n"+n("noActiveState")),u.setTitle({title:e})},l.hn("showActionIcon"))}),r.Oe(600,function(){function t(){S&&(S.Go=null),B=y=S=v=null,b&&clearTimeout(b),p&&clearTimeout(p),w=k=M=b=p=0,h="",r.x()}function e(){var n=Date.now()-w;if(n>5e3||n<-5e3)return t();b=setTimeout(e,3e4)}function i(){var t,n;if(p=0,(t=S)&&!t.Xo)return S=null,t.Go?((n=Date.now())<w&&(w=n-1e3),u(t.oo,t.Go)):void 0}function o(t,e,i,o,u){var s,f,a,_,d,p,U,b,w,x,R,C,O,D,N,I,E,j;if(t.Go){for(S=null,f=(s=e.length>0)?e[0]:null,_={},k=o,M=u,s&&(g||null!=e[0].s)&&(B=new Map),y=[],d=new Set,p=(" "+l.nn.s+" ").includes(" type-letter "),U=0,b=i?0:1,w=e.length;U<w;U++)R=(x=e[U]).title,C=x.u,O=x.e,D="",N=null!=x.s,I=g&&!(i&&0===U)&&("tab"===O?x.s!==m.mt:"history"===O&&!N),d.has(C)?C=":"+(U+b)+" "+C:d.add(C),I&&(_.Uo=O,D=" ~"+(U+b)+"~"),E={content:C,description:D=(R||p?(R?R+" <dim>":"<dim>")+(p?"["+x.e[0].toUpperCase()+"] ":"")+(R?"-</dim> <url>":"</dim><url>"):"<url>")+x.textSplit+"</url>"+(D&&"<dim>"+D+"</dim>")},I&&(E.deletable=true),N&&(_.Oi=x.s),(I||N)&&(B.set(C,_),_={}),y.push(E);if(v=t.oo,i)if("search"===f.e){if(a=((j=f.p)&&"<dim>"+(r.R(j)+c)+"</dim>")+"<url>"+f.textSplit+"</url>",T=2,f=e[1])switch(f.e){case"math":y[1].description=f.textSplit+" = <url><match>"+f.t+"</match></url>"}}else T=3,a=y[0].description;else 1!==T&&(a="<dim>"+n("OpenC")+"</dim><url>%s</url>",T=1);i&&(h=e[0].u,y.shift()),a&&chrome.omnibox.setDefaultSuggestion({description:a}),t.Go(y),r.x()}else S===t&&(S=null)}function u(t,n){var u,s,f,a;t=t.trim().replace(r.F," "),S&&(S.Go=(u=t===S.oo)?n:null,u)||(t!==v?1===k&&t.startsWith(v)?n([]):(S={Go:n,oo:t,Xo:false},p||(s=Date.now(),(f=l.nn.t+w-s)>30&&f<3e3?p=setTimeout(i,f):(S.Xo=true,b||(b=setTimeout(e,3e4)),w=s,B=y=null,h="",a=k<2||!t.startsWith(v)?0:3===k?t.includes(" ")?0:8:M,d.Qt(t,{o:"omni",t:a,r:x,c:U,f:1},o.bind(null,S))))):y&&n(y))}function s(t,n,e){return t?":"===t[0]&&/^:([1-9]|1[0-2]) /.test(t)&&(t=t.slice(" "===t[2]?3:4)):t=r.K(""),"file://"===t.slice(0,7).toLowerCase()&&(t=r.ze(t)),null!=e?a.rt[5]({s:e}):a.rt[6]({u:t,r:"currentTab"===n?0:"newForegroundTab"===n?-1:-2},null)}var c,_,g,v,h,S,p,B,U,y,b,w,T,k,M,x,R=chrome.omnibox;R&&(c=n("colon")+n("NS"),g=!!(_=R.onDeleteSuggestion)&&"function"==typeof _.addListener,v=null,h="",S=null,p=0,B=null,U=128,y=null,b=0,T=0,k=0,M=0,x=f<60?6:12,R.onInputStarted.addListener(function(){if(chrome.windows.getCurrent(function(t){var n=t&&t.width;U=n?Math.floor((n-160/devicePixelRatio)/7.72):128}),b)return t()}),R.onInputChanged.addListener(u),R.onInputEntered.addListener(function n(e,o){var u,l=S;if(l&&l.Go){if(l.Go=n.bind(null,e,o),l.Xo)return;return p&&clearTimeout(p),i()}return e=e.trim().replace(r.F," "),null===v&&e?d.Qt(e,{o:"omni",t:0,r:3,c:U,f:1},function(t,n){return n?s(t[0].u,o,t[0].s):s(e,o)}):(h&&e===v&&(e=h),u=B&&B.get(e)&&B.get(e).Oi,t(),s(e,o,u))}),g&&_.addListener(function(t){var n=parseInt(t.slice(t.lastIndexOf("~",t.length-2)+1))-1,e=y&&y[n].content,r=e&&B&&B.get(e)||null,i=r&&r.Uo;if(i)return":"===e[0]&&(e=e.slice(e.indexOf(" ")+1)),a.Yt({t:i,u:"tab"===i?r.Oi:e});console.log("Error: want to delete a suggestion but no related info found (may spend too long before deleting).")}))}),f>=85&&r.Oe(100,function(){var t=function(t,n,e){var i,o,u,s;if("chrome://newtab/"===e.url&&"loading"===n.status)for(i=l.E.Cn,o=location.origin.length,u=0,s=i.length-1;u<s;++u)chrome.tabs.executeScript(t,{file:i[u].slice(o)},r.S)},n=function(){chrome.permissions.contains({origins:["chrome://new-tab-page/"]},function(e){var i=r.S();if(i)return i;chrome.permissions[e?"onRemoved":"onAdded"].addListener(n),chrome.permissions[e?"onAdded":"onRemoved"].removeListener(n),chrome.tabs.onUpdated[e?"addListener":"removeListener"](t)})};n()}),chrome.runtime.onInstalled.addListener(l.He.Ve=function(t){var e=t.reason;if("install"===e)e="";else{if("update"!==e)return;e=t.previousVersion}l.He.Ve&&(chrome.runtime.onInstalled.removeListener(l.He.Ve),l.He.Ve=null,r.Oe(500,function(){var i,o;chrome.tabs.query({status:"complete"},function(t){var n,e,i,o,u=chrome.tabs,s=r.S,f=/^(file|ftps?|https?):/,a=location.origin.length,c=l.E.Cn;for(n=t.length,e=c.length-1;0<=--n;)if(f.test(t[n].url))for(i=t[n].id,o=0;o<e;++o)u.executeScript(i,{file:c[o].slice(a),allFrames:true},s)}),console.log("%cVimium C%c has been %cinstalled%c with %o at %c%s%c.","color:red","color:auto","color:#0c85e9","color:auto",t,"color:#0c85e9",new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toJSON().slice(0,-5).replace("T"," "),"color:auto"),l.E.Un&&console.log("Sorry, but some commands of Vimium C require the permission to run in incognito mode."),e?parseFloat(l.E.kn)<=parseFloat(e)||((i=l.He).Be?i.Be(6e3):i.Be=true,l.rn("notifyUpdate")&&(e="vimium_c-upgrade-notification",o={type:"basic",iconUrl:location.origin+"/icons/icon128.png",title:"Vimium C "+n("Upgrade"),message:n("upgradeMsg",[l.E.En])+n("upgradeMsg2")+"\n\n"+n("clickForMore")},f<67&&(o.isClickable=true),f>=70&&(o.silent=true),chrome.notifications&&chrome.notifications.create(e,o,function(t){var n;if(n=r.S())return n;e=t||e,chrome.notifications.onClicked.addListener(function(t){t===e&&(chrome.notifications.clear(e),a.rt[19]({u:r.K("vimium://release")}))})}))):(l.zn&&l.zn()||Promise.resolve()).then(function(){return a.Vn?new Promise(function(t){return setTimeout(t,200)}):0}).then(function(){a.rt[19]({u:l.E.An+"#commands"})})}))}),r.De=function(t){function n(){if(Math.abs(performance.now()-e)<1e5)i=setTimeout(n,3e5);else{i=0;var t=l.pn;KeyMappings&&(t.keyMappings=null,KeyMappings=null)}}var e=0,i=0,o=0;return r.De=function(t){t&&(o=o+t>0?o+t:0),o>0||!KeyMappings?i&&(clearTimeout(i),i=0):(e=performance.now(),i=i||setTimeout(n,3e5))},r.De(t)},r.Oe(1200,function(){l.He.Ve&&chrome.runtime.onInstalled.removeListener(l.He.Ve),l.He.Ve=null,document.documentElement.innerHTML="",r.x()});