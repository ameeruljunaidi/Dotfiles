__filename="pages/options_popup.js",define(["./async_bg","./options_base"],function(n,t){"use strict";var o,e,i,u,r,c,l,a="",f=0,s=true,d=null,v=-1,h=null,m=t.$("#state-action"),w=t.$("#saveOptions"),p=m.nextElementSibling,g=p.nextElementSibling,b=(function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return __extends(e,n),e.prototype.es=function(t,o){n.prototype.es.call(this,e.Ru(),o)},e.prototype.ls=function(n){if(!n)return false;var t=o.Kn.get(n);return!(1===t.t?!i.startsWith(t.v)||a&&!a.startsWith(t.v):!t.v.test(i)||a&&!t.v.test(a))},e.prototype.fs=function(o){var i,u,r,c;n.prototype.fs.call(this,o),(i=this).fs=null,document.documentElement.style.height="",e.prototype.ls=t.Cs.prototype.ls,u=i.gr.filter(function(n){return n.Wr}),f=(r=u.length>0)?2:1,r?(c=u[0].ds,_(true)):(i.es("",false),c=i.gr[i.gr.length-1].ds),t.Bs(function(){return c.focus()})},e.prototype._s=function(t,e,u){var r,c,l=t.ps.pattern===e;n.prototype._s.call(this,t,e,u),l||(r=o.Jn(e,""),c=t.as,(1===r.t?i.startsWith(r.v):r.v.test(i))?c.title=c.style.color="":(c.style.color="red",c.title="Red text means that the pattern does not\nmatch the current URL."))},e.Ru=function(){var n=i.startsWith("http:")?"^https?://"+i.split("/",3)[2].replace(/[.[\]]/g,"\\$&")+"/":i.startsWith(location.origin)?":vimium:/"+new URL(i).pathname.replace("/pages",""):/^[^:]+:\/\/./.test(i)&&!i.startsWith("file:")?":"+i.split("/",3).join("/")+"/":":"+i;return e.Ru=function(){return n},n},e})(t.Cs),_=function(n){var u,c,l=3===f,a=l?o.at(i,e):o.it(i,e,h.gs(true));a&&(a=R(a)),n&&(d=f>=2?a:null),f=2,u=a===d,c=!!a&&a.length>2&&"^"===a[0],m.textContent=(l?a?t.qs("o137")+t.qs(c?"o138":"o139"):t.qs("o140"):t.qs(u?"o141":"o142")+t.qs(a?c?"o138":"o139":u?"o143":"o143_2")).replace(" to be","")+t.qs("colon")+(a?t.qs("NS"):""),p.className=a?"code":"fixed-width",p.textContent=a?c?a.slice(2):a:t.qs(null!==a?"o144":"o145")+t.qs("o146"),g.textContent=r&&!l&&u?t.qs("o147",[t.qs(0!==v?"o144":"o145")]):r?t.qs("o148"):"",w.disabled=u,w.firstChild.data=t.qs(u?"o115":"o115_2")},x=function(){if(!w.disabled){var i=o.Kn;n.Ks.a.wt("reset silent",e.t),h.js(),setTimeout(function(){o.Kn=i,setTimeout(O,150)},50),f=3,_(true),w.firstChild.data=t.qs("o115_3"),w.disabled=true,s=true}},R=function(n){var t,o,e,i;for((t=(n=n.trim()).length>2&&n.startsWith("^"))&&(n=n.slice(1).trimLeft()),o=Object.create(null),e=0,i=n.split(" ");e<i.length;e++)o[i[e]]=1;return(t?"^ ":"")+Object.keys(o).sort().join(" ")},k=function(t,o){o&&o.preventDefault(),n.Ks.a.wt(t.toLowerCase(),e.t),window.close()},O=function(){u=2!==e.s?"Disable":"Enable",v=(r=!!(1&e.f))?e.s:-1;var n=t.$("#toggleOnce"),o=n.nextElementSibling;t.Bs(function(){n.firstElementChild.textContent=(t.qs(u)||u)+(r?"":t.qs("Once")),n.onclick=k.bind(null,u),p.id="state-value",o.classList.toggle("hidden",!r),r&&(o.firstElementChild.onclick=k.bind(null,"Reset"))})},j=function(o){var e=t.$(".options-link"),i=n.bs.E.An;o.startsWith(i)?(e.nextElementSibling.remove(),e.remove()):(e.href!==i&&(e.href=i),e.onclick=function(t){t.preventDefault();var o=n.Ks.Object.create(null);o.u=n.bs.E.An,n.Ks.a.rt[19](o),window.close()})};Promise.resolve((n.Ks.r.De(1),n.bs.zn&&n.bs.zn())).then((l=function(l){var d=l[0],v=d.url,m=n.Ks.a.dn(d.id),p=t.$("#blocked-msg");if(!(m||d&&v&&"loading"===d.status&&/^(ht|s?f)tp/.test(v)))return c(p,d,v),void j(v);t.Bs(function(t){p.remove(),p=null;var o=document.documentElement.classList;o.toggle("auto-dark",!!n.bs.en.d),o.toggle("less-motion",!!n.bs.en.m),t.textContent=n.bs.E.En},t.$(".version")),o=n.Ks.Exclusions,(e=!m||m[0].s.i&&!n.Ks.r.G.test(m[0].s.u)?{i:0,a:d.incognito,s:0,f:0,t:d.id,u:v}:m[0].s).i&&(a=((n.Ks.a.dn(d.id,0)||{}).s||{}).u||v),i=e.u,w.onclick=x,document.addEventListener("keyup",function(n){13===n.keyCode&&(n.ctrlKey||n.metaKey)&&(setTimeout(window.close,300),s||x())}),j(v),O(),(function(){var e,i,c=n.bs.rn("exclusionRules"),l=o.Kn=new n.Ks.Map,a=o.Zn;for(e=0,i=c.length;e<i;e++)l.set(c[e].pattern,a[e]);n.bs.en.o||window.addEventListener("keydown",function(n){n.altKey&&(88===n.keyCode||r&&90===n.keyCode)&&!(n.shiftKey||n.ctrlKey||n.metaKey)&&(n.preventDefault(),n.stopImmediatePropagation(),k(88===n.keyCode?u:"Reset"))}),h=new b(t.$("#exclusionRules"),function(){if(s){s=false;var n=t.$("#helpSpan");n&&(n.nextElementSibling.style.display="",n.remove()),w.removeAttribute("disabled"),w.firstChild.data=t.qs("o115_2")}_(f<2)}),t.Ds.zs=false,h.ks(),window.onunload=function(){o.Kn=null,n.Ks.r.De(-1)}})(),t.Es&&t.Bs(t.Es)},function(){chrome.tabs.query({currentWindow:true,active:true},l)})),c=function(o,e,i){var u,r,c,l,a,f=document.body,s=document.documentElement;f.innerText="",o.style.display="",o.querySelector(".version").textContent=n.bs.E.En,u=o.querySelector("#refresh-after-install"),e&&i&&/^(ht|s?f)tp/i.test(i)?/\bOpera\//.test(navigator.userAgent)&&/\.(google|bing|baidu)\./.test(i.split("/",4).slice(0,3).join("/"))&&(o.querySelector("#opera-warning").style.display=""):u.remove(),f.style.width="auto",f.appendChild(o),null==(c=(r=i.startsWith(location.protocol)&&!i.startsWith(location.origin)?new URL(i).host:"")?n.bs.an.get(r):null)||c||((l=t.$("#injection-refused")).style.display="",l.nextElementSibling.remove(),t.$("#doAllowExt").onclick=function(){var t,o=n.bs.rn("extAllowList"),e=o.split("\n"),i=r;e.indexOf(i)<0&&(t=e.indexOf("# "+i)+1||e.indexOf("#"+i)+1,e.splice(t?t-1:e.length,t?1:0,i),o=e.join("\n"),n.bs.in("extAllowList",o)),this.onclick=null,chrome.tabs.query({active:true,currentWindow:true},function(n){var t=function(){return setTimeout(function(){return location.reload()},500),chrome.runtime.lastError};return n&&n[0]?chrome.tabs.reload(n[0].id,t):chrome.tabs.reload(t),chrome.runtime.lastError})}),s.classList.toggle("auto-dark",!!n.bs.en.d),s.style.height="",a=t.$("#retryInject"),/^(file|ftps?|https?):/.test(i)&&e?a.onclick=function(t){var o,i,u,r;if(t.preventDefault(),!n.Ks.a.dn(e.id))for(o=location.origin.length,i=function(){},u=0,r=n.bs.E.Cn;u<r.length;u++)chrome.tabs.executeScript(e.id,{file:r[u].slice(o),allFrames:true},i);window.close()}:(a.nextElementSibling.remove(),a.remove())}});