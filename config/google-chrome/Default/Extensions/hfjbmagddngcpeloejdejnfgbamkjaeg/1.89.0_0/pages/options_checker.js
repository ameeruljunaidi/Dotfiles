__filename="pages/options_checker.js",define(["./async_bg","./options_base","./options_wnd"],function(n,t,r){"use strict";var e={Pr:0,Us:null,vr:function(){function n(n,t,r){var e,s,i,u,c,o,a="";if(r.length>2&&":"===r[r.length-2]&&(a=r.slice(-2),r=r.slice(0,-2)),e=t.toLowerCase(),s=r.length>1,i=e.includes("s-"),u=r.toUpperCase(),!s){if(!e)return n;if(i&&e.length<3)return a?"<"+u+a+">":u}return c=r.toLowerCase(),e=e.includes("v-")?"v-":(o=e).length<4?o:o.slice(0,-1).split("-").sort().join("-")+"-",r!==c&&!i&&(e+="s-"),e||s||a?"<"+e+c+a+">":r}this.Us=function(t){return t.replace(/<(?!<)((?:[ACMSVacmsv]-){0,4})(.[^>]*)>/g,n)},this.Ls=this.Ls.bind(this),this.Hs=this.Hs.bind(this),this.Vs=this.Vs.bind(this),this.vr=null},Gs:function(n,t){return t?"\\u00"+t:"\\\\"},Vs:function(n,t,r,e){var s,i;r?t='"'+(r=r.replace(/\\(?:x([\da-z]{2})|\\)/gi,this.Gs))+'"':e||"\\\\"!==t||(t="\\"),s="",t.startsWith("{")&&(s=t=t.replace(/([{,] ?)(\w+):/g,'$1"$2":'));try{if("string"!=typeof(i=JSON.parse(t)))return true!==i?s?"="+s+e:n:"";t=i}catch(n){r&&(t=r)}return"="+(t=(t=t&&t.replace(/\\(\\|s)/g,function(n,t){return"s"===t?" ":n}))&&JSON.stringify(t).replace(/\s/g,this.Is))+e},Is:function(n){return"\\u"+(n.charCodeAt(0)+1048576).toString(16).slice(2)},Ls:function(n,t,r,e){var s,i,u,c=this.Us(r);return c!==r&&(console.log("KeyMappings Checker:",r,"is corrected into",c),r=c),"mapkey"===t.replace("#","").trim().toLowerCase()&&(u=(i=(s=e.match(/^\s*\S+/))&&s[0].trim())&&this.Us(i))!==i&&(console.log("KeyMappings Checker:",i,"is corrected into",u),e=e.replace(i,u)),this.Hs("",t,r,e)},Qs:function(n,t,r){return t.replace("map","mapKey")+(3===r.length?r[1]:r)},Hs:function(n,t,r,e){return(e.includes("createTab")||e.includes("openUrl"))&&/^\s+(createTab|openUrl)\s/.test(e)&&!/\surls?=/i.test(e)&&(e=this.Ws(e)),t+r+(e?e.replace(/=("(\S*(?:\s[^=]*)?)"|\S+)(\s|$)/g,this.Vs):"")},Ws:function(n){var t,r=[];return(n=(n+" ").replace(/\s(\w+:[^=\s]+|[^\s=]+:\/\/\S+)(?=\s|$)/g,function(n,t){return r.push(t),""}).trimRight())+((t=r.length)>1?" urls=":t?" url=":"")+(t?JSON.stringify(t>1?r:r[0]):"")},ws:function(n){return n?(this.vr&&this.vr(),n=(n=(n=(n=(n=n.replace(/\\\\?\n/g,function(n){return 3===n.length?n:"\\\r"})).replace(/^([ \t]*(?:#\s?)?map\s+(?:<(?!<)(?:.-){0,4}.[\w:]*?>|\S)\s+)(<(?!<)(?:[ACMSVacmsv]-){0,4}.\w*?>)(?=\s|$)/gm,this.Qs)).replace(/^([ \t]*(?:#\s?)?(?:un)?map(?:[kK]ey)?\s+)(\S+)([^\n]*)/gm,this.Ls)).replace(/^([ \t]*(?:#\s?)?(?:command|shortcut)\s+)(\S+)([^\n]*)/gm,this.Hs)).replace(/\\\r/g,"\\\n").trim()):n}};t.Ds.Jo.keyMappings.$s=e,e=null,t.Ds.Jo.searchUrl.$s={Pr:0,ws:function(r){var e,s,i,u=new n.Ks.Map;return n.Ks.r.Pe("k:"+r,u),null==(e=u.get("k"))?n.bs.rn("searchUrl",true):(s=n.Ks.r.K(e.xe,null,-2),n.Ks.r.V>2?(i=t.qs("nonPlainURL",[e.xe]),console.log("searchUrl checker:",i),t.Ds.Jo.searchUrl.Xs(i),n.bs.rn("searchUrl",true)):(s=s.replace(n.Ks.r.F,"%20"),e.qe&&"k"!==e.qe&&(s+=" "+e.qe),t.Ds.Jo.searchUrl.Xs(""),s))}},t.Ds.Jo.vimSync.Rs=function(){var n,r,e,s;if(!this.Os&&true===this.gs()){for(e in r=0,n=t.Ds.Jo)n[e].Os||++r;if(s=r>1,setTimeout(alert,100,t.qs(s?"changedBeforeSync":"warningForSync")),s)return false}return true},t.Ds.Jo.keyboard.$s={Pr:0,ws:function(t){return null!=t&&2===t.length&&t[0]>0&&t[0]<4e3&&t[1]>0&&t[1]<1e3?[+t[0],t[1]]:n.bs.sn.keyboard}},(function(){function e(t){n.Ks.KeyMappings||n.Ks.r.pe("KeyMappings"),t&&this.removeEventListener("input",e)}var s,i,u,c=r.loadChecker.Ys;for(r.loadChecker.Ys="",s=0,i=t.$$("[data-check]");s<i.length;s++)(u=i[s]).removeEventListener(u.dataset.check||"input",r.loadChecker);if("keyMappings"===c)return e();t.Ds.Jo.keyMappings.$t.addEventListener("input",e)})()});