__filename="pages/options_base.js",define(["exports","./async_bg"],function(t,i){"use strict";var n,s,e,u,r,h,o,c,a,f,l,p,d,v,m,y,g=function(t){return document.querySelector(t)},_=chrome.i18n.getMessage,x=function(t,i){return(i||document).querySelectorAll(t)},N=chrome.i18n.getMessage("lang1");if(N){if(n=navigator.language||_("lang2"),s=_("keyMappingsP"),e=g("#keyMappings"),s&&e&&(e.placeholder=s),n&&("zh"!==N||"zh-CN"!==n))for(u=0,r=x("input[type=text], textarea");u<r.length;u++)(e=r[u]).lang=n;for(h=0,o=x("[data-i]");h<o.length;h++)a=(c=(e=o[h]).dataset.i).endsWith("-t"),((s=_(a?c.slice(0,-2):c))||"NS"===c)&&(a?e.title=s:e.innerText=s);document.documentElement.lang="zh"===N?"zh-CN":N}window.__extends=function(t,i){var n=function(){this.constructor=t};n.prototype=i.prototype,t.prototype=new n},m=[],y=function(){var t,i,n=m.length;for(t=0,i=m;t<i.length;t++)(0,i[t])();m.length>n?(m.splice(0,n),Promise.resolve().then(y)):m.length=0},f=function(t,i){m.length<=0&&Promise.resolve().then(y),9===i?m.unshift(t):m.push(i?t.bind(null,i):t)},l=function(t,i,n,s){var e,u=0,r=function(){var h=Date.now()-e;if(!(h<i-4&&h>=0))return u=0,e!==s?t.call(n):void 0;u=setTimeout(r,i-h)};return s=s?1:0,function(){if(e=Date.now(),!u)return u=setTimeout(r,i),s?(s=e,t.call(n)):void 0}},d=(function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.u=p.p,i}return __extends(i,t),i.prototype.vr=function(t){var n,s,e,u,r,h,o=this;if(this.o=t.querySelector("#exclusionTemplate").content.querySelector(".exclusionRule"),N){for(n=void 0,s=void 0,e=0,u=x("[data-i]",t);e<u.length;e++)(s=_((n=u[e]).dataset.i))&&(n.innerText=s);for(r=0,h=x("[title]",this.o);r<h.length;r++)(s=(n=h[r]).title)?(s=_(s))&&(n.title=s):(s=_(n.getAttribute("title")))&&n.setAttribute("title",s)}this.ts=t.querySelector("tbody"),this.gr=[],this.ts.addEventListener("input",i.is),this.ts.addEventListener("input",this.ns),this.ts.addEventListener("click",function(t){return o.ss(t)}),g("#exclusionAddButton").onclick=function(){return o.es("")},p.us&&(this.o.draggable=true),f(function(){return o.rs&&o.rs()})},i.prototype.hs=function(){},i.is=function(t){var i=t.target.vnode;i&&(i.os=true)},i.prototype.es=function(t,i){this.cs(this.ts,{pattern:t,passKeys:""});var n=this.gr[this.gr.length-1];false!==i&&f(function(){return n.as.focus()}),t&&this.ns(),this.hs(1)},i.prototype.fs=function(t){if(this.ts.textContent="",this.gr=[],t.length<=0);else if(1===t.length)this.cs(this.ts,t[0]);else{var i=document.createDocumentFragment();t.forEach(this.cs.bind(this,i)),this.ts.appendChild(i)}return this.hs(t.length)},i.prototype.ls=function(){return true},i.prototype.cs=function(t,i){var n,s,e,u,r,h=i.pattern,o=i.passKeys,c={ps:{pattern:h,passKeys:o},os:false,Wr:false,as:null,ds:null};this.ls(h)?(s=(n=document.importNode(this.o,true)).querySelector(".pattern"),e=n.querySelector(".passKeys"),u=o.trimRight(),s.value=h,h&&(s.placeholder=""),e.value=u,u&&(e.placeholder=""),(r=c).Wr=true,r.as=s,r.ds=e,s.vnode=r,e.vnode=r,this.gr.push(r),t.appendChild(n)):this.gr.push(c)},i.vs=function(t){t.ps.pattern&&t.ds.placeholder&&(t.ds.placeholder="")},i.prototype.ss=function(t){var i,n=t.target;if("path"===n.localName&&(n=n.parentElement.parentElement),n.classList.contains("remove"))return(n=n.parentNode.parentNode).classList.contains("exclusionRule")?(i=n.querySelector(".pattern").vnode,n.remove(),this.gr.splice(this.gr.indexOf(i),1),this.ns(),this.hs(0)):void 0},i.ms=function(t,i,n){var s=n.toLowerCase();return n!==s?"<"+i+"s-"+s+">":t},i.ys=function(t){return t&&t.replace(/<(?!<)((?:[acm]-){0,3})([^a-z\d][\dA-Z]*)>/g,i.ms)},i.prototype.gs=function(t){var n,s,e,u,r,h,o,c,a,f,l=[];for(t=true===t,n=0,s=this.gr;n<s.length;n++)e=s[n],t&&!e.Wr||(e.os?(u=e.as.value.trim(),r=false,h=e.ds.value,u?((o=u.startsWith(":")?0:u.indexOf("://"))&&(/^[\^*]|[^\\][$()*+?\[\]{|}]/.test(u)?u.startsWith("^")||(r=!u.includes("/",o+3),u=(o<0?"^https?://":"^")+(u.startsWith("*")&&"."!==u[1]?"[^/]"+u:(u=u.replace(/\./g,"\\.")).startsWith("*")?u.replace("*\\.","(?:[^./]+\\.)*?"):u.replace("://*\\.","://(?:[^./]+\\.)*?"))):(r=!u.includes("/",o+3)&&!u.startsWith("vimium:"),u=(o<0?":http://":":")+(u=u.replace(/\\(.)/g,"$1")))),r&&(u+="/"),h&&((c=(h=i.ys(h)).match(/<(?!<)(?:a-)?(?:c-)?(?:m-)?(?:s-)?(?:[a-z][\da-z]+|[^\sA-Z])>|\S/g))&&((a="^"===c[0]&&c.length>1)&&c.shift(),c.sort(),a?c.unshift("^"):"^"===c[0]&&(c.shift(),c.push("^"))),h=(h=c?c.join(" ")+" ":"").replace(/<escape>/gi,"<esc>")),e.ds.title!==(f=h?h.length>1&&"^"===h[0]?"only hook such keys":"pass through such keys":"completely disabled")&&(e.ds.title=f),this._s(e,u,h),l.push(e.ps)):this._s(e,"",h)):e.ps.pattern&&l.push(e.ps));return l},i.prototype._s=function(t,n,s){var e=!t.ps.passKeys&&!!s;t.ps={pattern:n,passKeys:s},t.os=false,e&&i.vs(t)},i.prototype.xs=function(){var t,i,n,s;for(t=0,i=this.gr;t<i.length;t++)(n=i[t]).Wr&&(n.as.value!==n.ps.pattern&&(n.as.value=n.ps.pattern),s=n.ps.passKeys.trim(),n.ds.value!==s&&(n.ds.value=s))},i})(p=(function(){function t(t,n){this.$t=t,this.Ns=t.id,this.Ss=this.ns=null,this.Os=false,this.Ns in i.bs.un&&(n=this.Js.bind(this,n)),this.ns=l(n,330,this,1),this.vr(t)}return t.prototype.xs=function(){},t.prototype.ks=function(){this.Os=true,this.Ss=i.bs.rn(this.Ns),t.zs||this.fs(this.Ss)},t.prototype.Ps=function(t,n,s){var e=this.$s;return n?(s=e||!s?JSON.stringify(e?e.ws(t):t):s,i.Ks.JSON.parse(s)):e?e.ws(t):t},t.prototype.Rs=function(){return true},t.prototype.js=function(){var t=this.gs(),i="object"==typeof t,n=i?JSON.stringify(this.Ss):this.Ss,s=i?JSON.stringify(t):t;s!==n&&(n=s,t=this.Ps(t,i,i?s:""),this.Ss=t=this.As(t,i,s),this.Os=true,(n!==(i?JSON.stringify(t):t)||this.Ms(t))&&this.fs(t,true),this.xs())},t.prototype.Ts=function(){return!this.u(this.Ss,i.bs.rn(this.Ns))},t.prototype.As=function(n,s){return s&&JSON.stringify(n)===JSON.stringify(i.bs.sn[this.Ns])&&(n=i.bs.sn[this.Ns]),i.bs.in(this.Ns,n),this.Ns in i.bs.un&&t.us.push(this.Ns),i.bs.rn(this.Ns)},t.prototype.Ms=function(){return false},t.p=function(t,i){return JSON.stringify(t)===JSON.stringify(i)},t.zs=true,t})()),v=i.f<48||devicePixelRatio<2&&i.f>=61?function(){var t=document.createElement("style"),n=devicePixelRatio,s=i.f>=61&&n>=1,e=s||i.f>=48?1/n:1;e=(""+(e+=999e-8)).slice(0,7).replace(/\.?0+$/,""),t.textContent=s?"html { --tiny: "+e+"px; }":"* { border-width: "+e+"px !important; }",document.head.appendChild(t)}:null,t.$=g,t.$$=x,t.Cs=d,t.Ds=p,t.Zs=l,t.Bs=f,t.qs=_,t.Es=v,Object.defineProperty(t,"Fs",{value:true})});